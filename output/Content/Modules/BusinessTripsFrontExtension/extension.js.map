{"version":3,"file":"extension.js","sources":["../../../../src/EventHandlers/SomeEventHandlers.ts","../../../../src/Index.ts"],"sourcesContent":["import { Numerator } from \"@docsvision/webclient/BackOffice/Numerator\";\r\nimport { MessageBox } from \"@docsvision/webclient/Helpers/MessageBox/MessageBox\";\r\nimport { CustomButton } from \"@docsvision/webclient/Platform/CustomButton\";\r\nimport { DateTimePicker } from \"@docsvision/webclient/Platform/DateTimePicker\";\r\nimport { NumberControl } from \"@docsvision/webclient/Platform/Number\";\r\nimport { TextArea } from \"@docsvision/webclient/Platform/TextArea\";\r\nimport { IEventArgs } from \"@docsvision/webclient/System/IEventArgs\";\r\nimport { Layout } from \"@docsvision/webclient/System/Layout\";\r\nimport { layoutManager } from \"@docsvision/webclient/System/LayoutManager\";\r\nimport { func } from \"prop-types\";\r\n\r\n//В разметке на «редактирование»: при изменении контролов «Даты командировки С:» или «по:» \r\n//и, если заполнены оба поля необходимо рассчитать кол-во дней в командировке и записать \r\n//в поле «Кол-во дней в командировке».\r\nexport async function dateSince_ChangeData(sender: DateTimePicker) {\r\n\tawait setTripDaysValue(sender);\r\n}\r\n\r\nexport async function dateTill_ChangeData(sender: DateTimePicker) {\r\n\tawait setTripDaysValue(sender);\r\n}\r\n\r\nasync function setTripDaysValue(sender: DateTimePicker) {\r\n\tlet layout = sender.layout;\r\n\tlet tripDaysContol = layout.controls.tryGet<NumberControl>(\"tripDays\");\r\n\tlet otherDateContolName = sender.params.name == \"dateSince\" ? \"dateTill\" : \"dateSince\";\r\n\tlet otherDateContol = layout.controls.tryGet<DateTimePicker>(otherDateContolName);\r\n\tif (!tripDaysContol || !otherDateContol) return;\r\n\r\n\ttripDaysContol.value = getDateDifference(sender, otherDateContol);\r\n}\r\n\r\nfunction getDateDifference(sender: DateTimePicker, otherDateContol: DateTimePicker) {\r\n\tlet senderDate = sender.value;\r\n\tlet otherDate = otherDateContol.value;\r\n\tlet senderDateOnly = senderDate.setHours(0, 0, 0, 0);\r\n\tlet otherDateOnly = otherDate.setHours(0, 0, 0, 0);\r\n\tlet milliseconds = Math.abs(senderDateOnly - otherDateOnly);\r\n\tlet millisecondsPerDay = 1000 * 60 * 60 * 24;\r\n\treturn Math.floor(milliseconds / millisecondsPerDay);\r\n}\r\n\r\n//В разметке на «чтение»: добавить на ленту кнопку, по нажатию на кнопку \r\n//выводить сообщение (MessageBox.ShowInfo) с краткой информацией по заявке: \r\n//«Номер заявки», «Дата создания», «Даты командировки С:», «по:», «Основание для поездки».\r\nexport async function shortInfo_click(sender: CustomButton) {\r\n\tlet layout = sender.layout;\r\n\tlet numberControl = layout.controls.tryGet<Numerator>(\"applicationNumber\");\r\n\tlet crDateControl = layout.controls.tryGet<DateTimePicker>(\"date\");\r\n\tlet sinceContol = layout.controls.tryGet<DateTimePicker>(\"dateSince\");\r\n\tlet tillContol = layout.controls.tryGet<DateTimePicker>(\"dateTill\");\r\n\tlet reasonControl = layout.controls.tryGet<TextArea>(\"reason\");\r\n\tif (!numberControl || !crDateControl || !sinceContol || !tillContol || !reasonControl) return;\r\n\r\n\tMessageBox.ShowInfo(\r\n\t\t\"Номер заявки: {0}\\n\".format(numberControl.hasValue() ? numberControl.value.number : \"не задано\")\r\n\t\t+ \"Дата создания: {0}\\n\".format(crDateControl.hasValue() ? crDateControl.value.toLocaleDateString() : \"не задано\")\r\n\t\t+ \"Даты командировки С: {0} \".format(sinceContol.hasValue() ? sinceContol.value.toLocaleDateString() : \"не задано\")\r\n\t\t+ \"по: {0}\\n\".format(tillContol.hasValue() ? tillContol.value.toLocaleDateString() : \"не задано\")\r\n\t\t+ \"Основание для поездки: {0}\".format(reasonControl.hasValue() ? reasonControl.value.toString() : \"не задано\")\r\n\t);\r\n}\r\n\r\n","﻿import * as SomeEventHandlers from \"./EventHandlers/SomeEventHandlers\";\r\nimport { extensionManager } from \"@docsvision/webclient/System/ExtensionManager\";\r\n\r\n\r\n// Главная входная точка всего расширения\r\n// Данный файл должен импортировать прямо или косвенно все остальные файлы, \r\n// чтобы rollup смог собрать их все в один бандл.\r\n\r\n// Регистрация расширения позволяет корректно установить все\r\n// обработчики событий, сервисы и прочие сущности web-приложения.\r\nextensionManager.registerExtension({\r\n    name: \"Template front extension\",\r\n    version: \"5.5.15\",\r\n    globalEventHandlers: [ SomeEventHandlers ]\r\n\r\n})"],"names":["MessageBox","extensionManager"],"mappings":"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"}